<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>Microbiome simulation</title>
    <meta charset="utf-8" />
    <meta name="author" content="Sven Kleine Bardenhorst" />
    <link href="libs/remark-css/default.css" rel="stylesheet" />
    <link href="libs/remark-css/default-fonts.css" rel="stylesheet" />
    <script src="libs/htmlwidgets/htmlwidgets.js"></script>
    <script src="libs/jquery/jquery.min.js"></script>
    <link href="libs/datatables-css/datatables-crosstalk.css" rel="stylesheet" />
    <script src="libs/datatables-binding/datatables.js"></script>
    <link href="libs/dt-core/css/jquery.dataTables.min.css" rel="stylesheet" />
    <link href="libs/dt-core/css/jquery.dataTables.extra.css" rel="stylesheet" />
    <script src="libs/dt-core/js/jquery.dataTables.min.js"></script>
    <link href="libs/dt-ext-fixedcolumns/css/fixedColumns.dataTables.min.css" rel="stylesheet" />
    <script src="libs/dt-ext-fixedcolumns/js/dataTables.fixedColumns.min.js"></script>
    <link href="libs/crosstalk/css/crosstalk.css" rel="stylesheet" />
    <script src="libs/crosstalk/js/crosstalk.min.js"></script>
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

# Microbiome simulation
## Benchmarking methods for differential abundance testing
### Sven Kleine Bardenhorst
### Institute for Epidemiology and Social Medicine
### 2020-09-18 (updated: 2020-09-29)

---




# Background

---

# Microbiome sequencing data
![16s gene](16s_var_region.png)

.pull-left[
- 16s rRNA gene sequencing
- shotgun metagenomic sequencing
- test
]

.pull-right[
![tree](tree.png)
]



---

# Microbiome data example
<div id="htmlwidget-cc5b71fdeab080657295" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-cc5b71fdeab080657295">{"x":{"filter":"none","extensions":["FixedColumns"],"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59"],[0,73,104,2716,53,815,145,0,73,17,291,320,218,0,178,147,100,2352,228,9166,0,1842,240,1869,6,2202,1744,266,12,2931,1770,6072,587,10668,0,581,0,66,171,0,2,0,142,37,606,387,258,158,269,469,39,0,10,0,35,9,0,460,1953],[11987,4,0,0,3971,462,120,0,0,6,0,305,1694,0,0,567,0,4045,5554,0,0,1164,1873,114,42,0,184,657,10,174,43,1193,2880,0,658,169,21,0,0,0,0,0,701,1361,0,0,2182,2181,3666,0,0,0,31,87,1939,1157,0,4671,0],[0,335,1387,574,3880,951,311,416,0,0,0,305,516,2896,1425,429,852,20826,1622,1157,0,315,2036,196,335,0,654,121,27,927,1747,1900,201,813,1072,3791,548,141,608,963,2535,1537,0,580,3542,0,4988,296,6536,1184,788,85,273,444,543,3064,0,1478,142],[0,0,0,125,8,176,53,0,0,0,30,0,0,7,0,0,0,0,0,0,0,77,0,0,0,0,0,0,0,15,0,0,126,1649,0,2408,352,0,0,0,32,256,320,0,0,0,26,0,0,21,0,0,0,771,0,0,0,44,0],[177,12,21,12,0,79,11,76,167,0,43,0,0,0,501,0,4,484,8,0,135,21,0,12,0,100,0,0,0,11,451,98,0,175,0,123,0,2,54,89,0,0,663,0,0,152,0,0,0,0,76,0,0,6,0,0,393,0,88],[3441,0,654,0,0,0,0,0,18,0,0,183,0,359,448,363,24,0,0,0,0,101,0,0,0,0,39,650,0,0,0,741,199,0,210,415,280,0,0,0,608,0,0,541,0,0,0,127,191,132,0,0,66,67,0,0,0,207,0],[0,0,66,19,1345,0,0,0,0,0,0,0,0,283,200,0,9,0,0,0,0,23,6,37,0,0,34,0,0,319,27,0,0,61,15,0,0,34,0,0,0,165,291,401,0,0,0,1197,0,73,8,0,3,68,25,10,0,0,0],[0,0,188,0,0,0,0,0,0,0,15,0,0,0,15,112,0,1703,0,0,0,58,0,89,0,21,147,226,0,0,0,0,650,0,120,5823,678,0,0,0,0,143,0,377,0,0,0,175,0,0,0,0,8,5,0,29,0,369,0],[0,0,0,0,0,0,0,0,0,0,0,0,60,0,22,0,0,0,0,2444,0,0,0,0,0,0,6,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,122,45,0,0,9,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,328,0,0,0,0,0,0,4,0,0,0,0,0,0,37,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,79,0,0,0,0,0,0,0,0,0,0,0,0],[296,3971,0,305,0,169,14,39,6,7598,27,6745,0,0,0,29,0,2,0,5,0,10,0,56,0,2225,53,23,0,0,15,0,6427,11,0,574,30,0,56,15,0,0,1470,0,0,0,15,4,0,0,0,0,0,3,0,0,13,0,0],[0,0,0,0,0,0,0,0,0,524,0,2403,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,236,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,8,0,0,0,124,0,212,0,0,0,0,0,0,3,0,0,0,0,0,0,0,0,0,0,0,0,0,160,0,0,0,2,0,0,0,3,0,0,0,6,0,33,7,0,0,0,0,0,0,0,0,0,28,0],[0,0,0,0,0,13,0,0,0,2466,0,4151,0,0,0,0,0,0,30,0,0,0,0,0,0,9,0,0,0,0,0,0,253,0,0,0,0,0,0,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,2225,0,642,0,0,0,0,0,0,0,0,0,0,0,11,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[7,75,0,44,0,102,22,69,0,4796,24,9129,0,0,0,0,0,0,32,0,0,0,0,0,0,0,58,0,0,3,22,0,3042,0,0,115,0,0,3,0,0,5,0,0,0,0,10,0,0,0,0,0,0,0,0,0,0,3,0],[969,0,28,0,0,0,0,0,0,65,0,0,0,0,0,3,0,0,17,0,0,0,3,0,0,0,0,0,0,0,0,0,785,0,0,0,48,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,19],[0,0,0,0,0,0,0,0,0,0,0,50,0,0,0,0,0,0,0,0,0,0,0,0,70,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,414,0,35,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,424,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,0,0,0,0,0,0,30,0,0,0,0],[1914,1370,339,44,508,4204,1601,3015,0,0,0,689,0,0,0,0,31,392,35,0,101,3923,1506,17719,286,4052,1996,0,479,8638,7086,3925,16122,2616,60,14082,0,0,560,0,0,266,0,0,65,0,0,2241,0,0,751,0,468,365,0,35930,0,236,86],[96964,2972,11061,4349,15461,8277,3834,12669,21137,1861,85,7887,16493,8406,851,569,3757,563,7026,5821,51,10437,10679,11648,58,11697,416,28840,1083,768,88,47533,12231,12612,2294,73386,25701,721,12,3701,9722,2197,24593,16874,15326,10690,576,2043,12108,0,21845,5689,5011,8700,7643,350,379,7758,308],[48971,439,814,936,459,2018,643,116,5065,0,833,17,13187,1295,12066,143,18,56664,4454,272,81,6626,985,13920,870,16684,1374,799,658,1017,672,2943,1623,529,840,5518,124,21,2791,279,838,131,326,310,752,3961,1192,170,1650,5878,12228,214,246,403,121,7516,9630,1221,227],[132398,491,23227,0,57626,9593,4539,825,1079,551,20,3774,0,264,535,5935,159,68,8984,0,388,23,11676,190,0,4986,13607,1984,20303,22,4,9779,1974,14070,9999,17742,558,0,0,7207,36183,23428,13547,728,31772,3266,5708,11650,15846,300,15504,0,5332,5372,7611,2258,2329,2322,171],[0,0,0,0,0,7,0,0,0,0,0,0,0,0,0,21,0,0,0,407,0,87,12,0,12,0,21,0,0,0,0,0,0,0,15,0,0,0,32,8,40,101,0,0,46,562,3189,639,724,88,0,0,19,536,45,0,0,84,2],[120,0,0,0,79,1150,333,0,0,0,646,0,0,0,0,65,0,0,373,625,0,219,129,0,53,0,545,0,0,0,0,0,837,0,0,697,401,0,39,0,0,119,0,0,0,0,278,0,250,27,7,0,0,54,37,0,0,127,0],[0,0,0,0,349,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2789,0,0,488,0,0,0,0,0,0,0,0,0,0,0,0,250,0,0,0,0,0,0,0,0,0,0],[9,0,0,0,8,38,6,0,0,397,0,5693,0,0,0,0,0,0,7,0,0,0,0,0,0,0,11,0,0,0,0,0,1958,0,0,43,3,0,0,0,0,0,0,0,0,0,111,0,0,0,0,0,0,9,11,0,0,58,0],[0,0,54,146,410,40,0,18,0,0,104,9,10,90,20,138,28,0,346,84,0,234,48,231,0,0,32,98,9,514,145,7,1550,0,13,510,762,0,73,30,203,22,6,0,0,42,20,71,487,30,44,0,0,41,6,11,0,30,0],[1233,0,476,0,0,5,22,0,4,0,47,0,18,0,395,59,45,0,0,16,0,0,32,44,310,23,0,3617,48,0,0,12,71,0,0,294,24,0,17,0,0,25,0,0,554,0,0,0,198,13,0,0,0,0,0,2346,0,0,0],[17,0,0,0,0,505,185,0,0,617,119,763,0,0,0,269,54,0,940,406,0,435,551,0,69,157,811,0,0,82,141,0,529,0,0,1191,9,0,0,0,0,693,0,0,78,140,1929,361,526,259,88,0,92,201,106,0,0,418,5],[0,167,0,0,0,0,0,0,0,0,1040,511,0,25,0,3,943,0,0,1415,0,1387,17,396,0,1780,0,0,0,0,33,0,0,0,0,3,0,170,0,0,0,59,0,0,0,0,175,0,0,33,0,7,0,0,0,0,133,0,0],[45,0,0,0,132,19,0,0,0,11497,0,40,0,0,0,0,40,7,0,0,0,0,10,0,3,0,104,0,19,28,0,0,181,0,0,50,6,0,0,0,0,20,0,0,0,0,117,0,35,0,0,0,0,3,0,0,0,41,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,26,0,0,0,0,0,0,0,0,0,0,269,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,69,21,0,0,0,0,0],[511,0,435,998,1786,14010,6257,26,0,0,290,0,1564,449,58,2417,1611,25,1302,11854,950,7,4288,54,7,594,3690,16,116,1225,237,17821,27981,0,659,43135,9463,48,1696,0,915,2911,743,319,1170,100,19562,824,4186,514,699,26470,10442,165,189,117,13427,2770,2974],[48792,24,5687,14897,4342,15300,5728,6006,343,0,23343,55,18192,10646,15881,5968,4855,2608,12172,4282,28328,11580,4261,6842,4620,469,3532,38141,442,32926,19405,8192,30304,13755,5480,31487,30272,14561,30470,9337,1750,931,7431,17258,5949,13691,9059,1872,7681,35970,4337,15261,7748,19800,7704,22409,29068,24202,20015],[0,80,0,189,0,38,8,899,0,1290,555,852,0,0,0,0,0,12697,0,0,149,25,0,184,0,356,45,0,589,720,1715,0,0,1586,134,0,0,16,58,0,0,0,0,0,0,0,121,0,0,98,711,288,169,9,0,0,301,0,0],[3545,0,0,1444,434,30,11,0,934,0,125,10,54,621,484,24,156,917,833,1705,6041,0,188,0,41,0,332,0,44,0,0,322,2110,107,239,1064,369,0,146,173,0,386,220,0,28,1320,17,22,1838,142,2032,236,121,158,464,8,323,272,7616],[9145,0,287,176,4511,2957,1087,954,0,3539,1667,29,10827,8477,4550,449,1310,8489,17044,2780,7585,73,1954,1443,1270,0,1031,6676,58,798,376,5595,9687,9097,19910,13605,1105,0,5200,1150,60,1016,2910,4173,1484,3634,2921,1692,3879,2567,4298,1889,1767,2021,2258,1980,55361,10138,3320],[0,0,0,0,24,0,0,0,0,0,0,0,0,0,0,0,0,0,12,0,0,0,0,0,0,94,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,281,0,0,0,0,0,0,0,0,0,0,0,0],[90,0,35,0,0,13,0,36,73,0,51,0,0,0,421,0,0,56,0,0,0,0,0,0,0,0,342,0,0,0,211,106,1051,225,131,110,163,1175,2974,272,38,104,67,50,585,21,53,7,742,1278,67,271,198,74,69,0,11167,0,31],[1717,0,81,544,186,583,191,0,0,0,130,39,0,265,148,275,215,0,739,209,0,375,143,1222,98,0,106,572,3,131,1036,144,1165,2920,649,3680,51,0,518,293,306,0,76,397,77,75,116,498,218,0,41,202,141,206,230,262,0,614,552],[2243,0,0,0,0,0,0,0,0,0,0,0,0,0,0,494,0,0,303,0,0,1210,86,0,61,0,0,0,0,0,0,0,241,0,188,0,418,0,0,0,0,113,0,0,0,0,0,0,130,0,0,0,165,223,0,11,0,0,221],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2939,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,21,13,0,26,261,59,159,0,0,0,0,0,0,0,0,0,0,170,0,0,184,360,0,0,0,183,0,0,25,266,0,1202,0,142,1086,0,0,0,0,0,0,0,0,0,7,174,1458,180,0,0,0,0,60,0,0,0,113,0],[15778,1478,1704,14894,5109,45639,13422,2918,126,148,5360,482,5398,8572,1062,2652,5923,305,6494,13730,26,36,535,9251,1397,0,76,16197,112,0,19042,8491,2416,7120,2565,41383,4032,0,7955,2784,5157,2697,5445,2238,794,2695,349,4579,6180,7808,5912,7211,3384,3575,4366,4329,43119,8164,12816],[0,0,0,0,35,0,0,0,0,0,119,0,0,0,0,0,0,857,0,0,0,11,0,0,0,0,0,0,0,6,8,0,349,0,0,0,47,0,0,0,0,0,0,0,0,0,0,0,0,5,0,0,0,0,6,0,0,0,0],[294,0,87,0,1657,1482,598,0,0,567,71,314,0,0,0,0,26,0,24,33,0,1544,376,0,319,0,0,3,0,0,11,0,7183,0,8,475,128,0,0,47,215,0,0,0,290,20,1461,29,0,15,0,0,0,5,0,498,0,1198,15],[10262,0,320,35,298,632,150,176,19,22,529,53,0,47,83,303,15,0,403,248,0,0,70,0,3,97,36,38,184,66,98,0,401,218,14,2083,141,107,272,90,377,486,118,0,885,90,924,59,175,87,144,0,61,74,460,108,1624,265,74],[401,0,976,56,118,638,226,0,26,480,133,6,631,783,2095,1219,383,0,893,0,0,0,615,802,67,0,1012,0,104,0,82,62,359,31912,2113,3738,780,0,771,1384,0,963,576,4847,566,248,2144,386,1471,380,42,307,189,104,604,64,2277,7058,3341],[19,0,0,0,0,62,24,0,0,656,29,1213,0,13,0,114,420,0,636,4921,0,4340,344,0,40,1633,278,0,0,48,0,0,20,0,5,78,0,0,0,39,123,116,0,0,195,34,1812,699,894,459,4,0,11,283,12,0,0,1203,0],[158004,0,13592,0,60294,5373,2452,1287,11416,0,0,0,0,1161,445,11886,0,21,6804,0,652,0,10326,0,0,287,863,0,9996,0,204,20,0,76,8543,57090,814,0,0,1101,11757,2785,3567,0,19580,766,3641,6835,19167,176,4246,0,1219,1225,5434,0,0,15184,3923],[44097,3957,26197,3,222470,9044,3493,0,11234,732,495,363,188,3555,11713,9342,5122,18,23401,1400,18,395,8060,8283,25,8130,16101,38,10643,40,252,1260,139,4910,30346,38311,653,0,0,699,8796,8080,6299,8142,6587,8155,11072,13877,27667,2925,749,34,3785,4460,1147,929,1111,951,9208],[0,0,0,0,460,0,0,0,0,0,0,9069,0,0,0,0,0,2,0,0,0,0,20,3,0,0,0,0,0,0,0,0,461,0,0,45,745,0,0,2757,9,0,0,0,0,0,0,186,27,0,0,0,36,52,0,0,0,10,734],[0,204,0,0,119,1243,409,0,3,0,28,0,0,0,10,140,0,0,111,0,425,0,0,141,6,34,0,0,0,0,143,0,4801,0,25,575,0,0,0,0,0,310,69,0,0,0,335,555,15,4,0,2,66,56,177,9,1109,0,0],[0,0,0,0,0,12,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,210,0,173,0,0,0,0,43,0,0,0,0,0,0,163,0,580,0,0,0,0,0,0,0,24],[1423,0,128,0,152,351,76,0,0,0,664,0,0,623,766,314,1280,0,27,0,0,0,284,52,13,0,52,0,0,599,52,0,679,0,270,367,583,0,547,0,2792,442,0,148,1302,508,206,0,5121,767,39,0,30,29,485,2278,0,1367,0],[0,0,0,0,0,0,0,0,0,0,0,42,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8,0,0,0,0,0,565,0,0,0,537,0,0,4,0,58,0,0,0,0,0,0,12,0,0,0,0,0,0,0,163,0,0],[89,0,2,199,24,3285,1014,56,0,5742,38,10223,2,101,0,0,3,0,548,6,0,19,0,37,56,1162,445,0,0,225,39,176,1232,0,327,25,1052,0,60,123,1609,630,17,4,14,0,258,85,210,22,311,0,148,324,114,7,0,337,190],[4841,6,2246,97,879,551,140,90,51,101,583,1702,164,460,2234,3739,212,0,378,28996,2223,15,1137,90,0,300,114,1483,484,2031,1443,5273,1580,98,363,2185,3942,512,9318,4683,4467,10425,1227,431,12721,326,1214,3398,23867,6233,1399,437,2150,2397,997,28,352,4042,3490],[276,0,407,6422,142,425,120,0,0,0,0,22,2227,905,1067,1779,414,1592,651,7,2106,22,275,16,124,0,63,0,5,831,169,581,298,0,519,1592,634,103,0,5228,197,151,69,452,1253,0,143,24,141,592,0,0,0,1880,73,99,0,154,170],[0,0,0,0,0,0,0,0,0,0,0,136,0,0,0,0,0,0,0,0,0,0,0,0,5,0,26,0,115,0,0,0,426,0,0,0,36,0,0,0,0,41,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,7,0],[18,9,0,5,44,300,78,0,0,17,107,940,0,0,0,0,0,0,813,0,4,12,39,104,377,0,215,7,0,0,0,0,1018,0,4,230,73,0,13,0,5,290,9,0,0,0,640,0,603,33,679,0,242,223,0,0,3,330,18],[56,0,0,23,19,336,70,50,0,2182,3,4768,0,3,0,0,34,0,520,8,555,249,0,0,0,145,1449,0,0,97,8,0,8433,0,0,342,436,0,15,34,61,213,0,0,0,0,3,5,64,4,124,5,5,10,0,0,13,67,16],[0,0,0,0,36,13,0,0,0,0,0,0,0,0,0,0,0,0,183,13,0,7,56,0,0,0,0,0,0,0,0,0,0,0,0,53,0,0,0,0,0,0,0,0,0,0,0,4,19,0,0,0,0,0,0,0,0,7,0],[6400,15,35,594,95,2499,913,0,0,1725,517,8742,0,121,42,3425,118,27,6414,6359,456,73,1080,0,53,0,397,183,470,655,3047,0,6425,0,101,12347,14909,0,2098,67,277,18693,1718,0,409,600,4583,461,1661,748,623,0,1004,954,1332,671,0,2368,1612],[138,280,39,27,30,0,0,10,0,100,0,1308,0,3,0,0,36,0,987,0,0,0,13,634,0,0,80,0,78,0,0,0,3600,0,1,198,57,0,0,13,153,115,0,0,0,0,285,732,875,0,0,0,0,32,5,0,0,62,0],[299,119,29,100,0,0,0,406,0,730,61,4725,0,0,0,456,33,0,39,191,0,15,52,40,0,80,428,18,0,256,19,0,511,16,274,87,0,0,0,168,520,142,175,161,295,0,665,3231,237,25,5,13,322,346,59,68,36,64,781],[24,0,0,0,5132,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,103,0,0,0,0,0,16,0,0,0,0,0,0,103,0,0,0,0,0,0,36,0,0,0,0,47,11,0,35,0,52,29,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,109,0,0,157,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3018,0,0,0],[122,0,261,5289,410,575,196,0,393,498,1169,0,437,579,7563,275,8162,99,9874,29720,3279,14,277,14167,0,22,972,123,35,5700,4731,4715,1807,29199,1026,2104,2313,9,593,1139,1268,964,7,9863,1017,1199,561,804,2672,1167,57,14,620,1166,1590,0,13934,2058,45],[217,148,0,0,0,0,0,135,0,0,0,595,0,0,0,0,0,48,0,0,404,0,0,0,0,124,0,0,0,0,0,0,67,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,765,0,0],[436,0,0,9,7796,0,0,18,272,0,488,714,160,0,0,0,0,86,96,26,1585,2311,15,301,0,0,0,0,0,6146,5154,0,0,6,0,0,0,14,157,0,8,0,6,0,0,132,56,312,0,11,80,0,0,0,0,0,203,0,0],[0,0,3455,0,2237,2495,624,0,4598,0,24213,0,0,12327,15318,2842,0,20,3,0,0,5809,4953,0,12217,0,150,3,5634,3,0,0,5961,0,26585,0,367,14935,0,0,0,1342,0,10194,0,0,0,19534,43058,0,0,10635,4413,416,0,6055,0,5701,0],[4633,407,5340,204,965,986,362,235,119,4,0,1428,0,4003,0,1227,178,114,75,0,0,0,1799,34,0,1431,94,17,274,0,0,1935,0,0,413,766,222,0,0,9,0,15,255,0,4613,315,104,590,929,5,8,0,24,30,420,0,0,63,369],[35,0,0,59,0,6,0,0,48,0,0,41,0,0,0,64,0,0,56,20,76,0,4,0,11,137,0,0,0,11,16,6,0,81,0,90,2184,0,22,0,0,0,3,86,47,4,18,27,40,0,23,23,13,0,31,0,57,11,2],[501,0,0,0,92,9,0,0,0,0,0,0,0,0,0,368,0,0,191,0,0,0,12,30,0,0,0,0,0,0,0,0,3037,0,0,191,89,0,0,0,0,55,0,0,87,0,0,0,0,0,4,0,0,0,8,0,0,0,0],[0,0,0,0,0,0,0,0,0,80,0,1860,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,10,0,0,0,0,0,0,0,6,0,0,0,0,0,0,0,0,0,0,0,41,0,1102,0,0,0,0,0,0,15,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,153,0,0,0,0,0,0,0,1736,0,0,0,0,111,2,0,17,0,0,0,0,0,0,0,13,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,10,0,317,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,260,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,350,0,0,0,0,0,0,0,0,0,0,992,0,0,0,0,0,24,0,0,0,0,0,0,0,0,0,0,0,0,575,0,0,0,0,0,323,287,0,0,625,0,3877,0,1218,7,0,0,0,132,0,0,0,0,0],[0,0,0,0,0,0,0,27,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3651,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[107,266,49,3580,0,281,86,16440,99,4,0,18,1140,0,6,0,148,21,0,11,80,0,123,85,3,104,489,24,140,250,51,15,319,1485,0,17,0,38,25950,0,16,123,2643,200,107,0,552,1978,74892,0,4,0,192,179,0,247,0,0,551],[0,77,0,0,0,0,0,0,0,0,0,0,0,0,0,25,0,0,0,0,0,0,0,0,0,185,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,412,433,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,613,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,5,0,0,0,0,0,0,0,0,0,0,0,0,0,9,0,0,0,0,0,0,0,0,0,591,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,79,96,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,1233,0,0,0,0,0,0,0,0,0,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,383,0,3825,26,37,4,0,0,130,0,1114,0,0,0,246,0,2,0,720,0,155,609,0,0,0,646,0,0,62,101,0,1020,0,0,4,0,22,200,5,213,0,0,0,4,57,326,0,0,0,0,0,0,14,27,0,0,0,4],[122,4,27,272,734,101,9,0,129,0,83,0,67,0,591,42,91,198,107,31,150,166,182,66,44,0,51,503,11,0,29,359,27,342,0,219,682,0,5,9,130,53,0,224,354,223,104,27,44,47,0,146,67,59,38,250,422,107,131],[1699,0,14,344,364,793,168,0,0,0,43,12,0,247,247,0,28,369,642,25,1365,95,172,0,0,0,0,0,0,890,1029,92,94,0,0,495,73,0,176,314,0,394,0,21,12,1276,548,144,171,0,0,156,59,59,54,0,0,63,2470],[0,0,0,0,0,241,107,0,0,129,0,235,0,0,0,0,0,0,0,7,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,68,184,0,0,0,0],[0,0,0,0,0,0,0,0,0,1250,0,0,0,0,0,78,0,0,0,0,0,0,211,0,0,0,309,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1119,0,0,0,891,0,0,0,0,0,0,0,0,0,0],[831,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[1197,0,11859,0,649,1340,673,0,1433,0,0,0,0,750,0,1211,0,0,173,0,0,0,1052,0,0,1014,1029,0,5895,0,0,129,0,0,2235,1252,142,0,0,36,1159,219,35,0,7263,186,2023,1080,55,0,1367,0,84,275,285,0,0,2474,0],[0,0,0,0,0,0,0,0,0,63,0,699,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[65,0,5,0,300,85,0,0,0,0,25,0,0,45,0,0,0,0,121,11,0,85,56,0,0,68,0,0,0,0,391,0,69,0,0,48,0,3,66,20,0,0,96,0,159,106,0,0,0,0,0,93,20,11,34,0,163,0,0],[0,12,40,6,0,767,178,3,0,0,85,0,0,2,0,3,0,57,0,0,13,9,9,0,0,219,56,0,44,0,0,0,0,0,0,649,88,0,0,34,0,0,14,0,4,135,93,2,43,0,53,0,1742,1583,37,13,0,0,4],[214,0,0,4,0,0,0,0,6,208,0,0,0,0,8,0,0,0,0,0,0,0,0,13,0,0,0,10,0,16,0,18,0,0,0,0,0,0,0,0,0,0,0,0,3,0,0,0,0,0,0,0,0,0,0,0,7,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,422,0,0,0,0,7519,0,0,0,0,0,0,0,0,1094,24,4,0,0,0,0,2502,0,0,0,0,0,0,3604,0,0,0,0,0,241,4745,0,0,0,0,110,0,702,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1820,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1583,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,47,0,0,0,0,0,137,0,21,0,228,0,9,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,96],[0,0,0,0,0,34673,15729,0,0,0,6,0,0,0,637,9556,1891,0,5,0,0,20,0,684,976,0,9005,0,60,0,0,0,0,0,298,0,0,0,0,0,0,112,0,0,4185,0,3266,9530,323,0,123,0,0,0,0,651,0,5880,0],[0,0,0,0,0,0,0,0,0,5355,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,546],[0,0,0,0,221,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,44,515,0,0,0,0,0,0,0,0,7,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,649,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,7,0,0,0,0,0,0,686,0,7730,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[47,4,0,0,61,0,0,0,0,0,38,0,0,0,0,9034,0,21,0,0,0,75,0,0,0,0,0,0,0,7,3,0,0,0,0,0,1099,0,0,0,0,0,0,0,243,74,0,0,0,0,0,0,0,0,0,6,5,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,426,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,0,0,0,0,0,0,0,1426,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,12290,0,0,0,1260,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,267,0,0,0,0,0,0,0,584,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,382,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,243,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1606,0,0,0,0,0,0,0,0,0,0,0,0],[525,0,59,0,0,0,0,0,0,906,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,32,0,6,0,0,0,0,12,0,0,0,0,0,2,45,20,21,6,21,2,12,0,4,0,42,0,80,0,0,0,89,0,0,0,0,0,0,5,0,0,0,0,0,0,0,3,0,0,0,0,0,0,0,6,0,0],[19,0,8,0,0,18,0,0,0,0,0,0,0,0,30,0,27,0,14,0,0,0,49,0,0,0,19,0,0,0,0,0,0,0,87,266,0,0,0,0,0,0,0,0,0,0,0,7,11,0,0,0,0,0,0,0,0,0,0],[617780,17408,111836,63750,406916,176121,66501,47556,58871,60645,64394,98018,73247,68805,82115,79820,38915,115809,130472,129173,58815,55984,74130,91122,25030,61496,88309,102639,58233,69297,72913,131335,188027,146446,122237,389578,108419,32698,97960,44324,92876,88476,75890,80417,126773,55197,96473,97229,279817,70596,80174,69810,52853,60565,47045,97506,187893,116866,78360]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Bifidobacterium<\/th>\n      <th>Adlercreutzia<\/th>\n      <th>Collinsella<\/th>\n      <th>Denitrobacterium<\/th>\n      <th>Eggerthella<\/th>\n      <th>Enterorhabdus<\/th>\n      <th>Olsenella<\/th>\n      <th>Senegalimassilia<\/th>\n      <th>Slackia<\/th>\n      <th>Anaerorhabdus<\/th>\n      <th>Bacteroides<\/th>\n      <th>Barnesiella<\/th>\n      <th>Odoribacter<\/th>\n      <th>Parabacteroides<\/th>\n      <th>Prevotella<\/th>\n      <th>Alistipes<\/th>\n      <th>Rikenella<\/th>\n      <th>Nubsella<\/th>\n      <th>Atopostipes<\/th>\n      <th>Enterococcus<\/th>\n      <th>Lactobacillus<\/th>\n      <th>Streptococcus<\/th>\n      <th>Clostridium.sensu.stricto<\/th>\n      <th>Thermobrachium<\/th>\n      <th>Geosporobacter<\/th>\n      <th>Dethiosulfatibacter<\/th>\n      <th>Acidaminobacter<\/th>\n      <th>Anaerovorax<\/th>\n      <th>Mogibacterium<\/th>\n      <th>Alkalibacter<\/th>\n      <th>Eubacterium<\/th>\n      <th>Lutispora<\/th>\n      <th>Heliobacillus<\/th>\n      <th>Anaerostipes<\/th>\n      <th>Blautia<\/th>\n      <th>Clostridium.XlVa<\/th>\n      <th>Coprococcus<\/th>\n      <th>Dorea<\/th>\n      <th>Eisenbergiella<\/th>\n      <th>Fusicatenibacter<\/th>\n      <th>Hespellia<\/th>\n      <th>Howardella<\/th>\n      <th>Hungatella<\/th>\n      <th>Lachnobacterium<\/th>\n      <th>Lachnospiracea_incertae_sedis<\/th>\n      <th>Lactonifactor<\/th>\n      <th>Robinsoniella<\/th>\n      <th>Roseburia<\/th>\n      <th>Ruminococcus2<\/th>\n      <th>Desulfurispora<\/th>\n      <th>Intestinibacter<\/th>\n      <th>Romboutsia<\/th>\n      <th>Anaerobacterium<\/th>\n      <th>Anaerotruncus<\/th>\n      <th>Butyricicoccus<\/th>\n      <th>Cellulosibacter<\/th>\n      <th>Clostridium.III<\/th>\n      <th>Clostridium.IV<\/th>\n      <th>Faecalibacterium<\/th>\n      <th>Gemmiger<\/th>\n      <th>Hydrogenoanaerobacterium<\/th>\n      <th>Intestinimonas<\/th>\n      <th>Oscillibacter<\/th>\n      <th>Pseudobacteroides<\/th>\n      <th>Ruminococcus<\/th>\n      <th>Sporobacter<\/th>\n      <th>Subdoligranulum<\/th>\n      <th>Vallitalea<\/th>\n      <th>Catenibacterium<\/th>\n      <th>Clostridium.XVIII<\/th>\n      <th>Erysipelotrichaceae_incertae_sedis<\/th>\n      <th>Faecalicoccus<\/th>\n      <th>Holdemanella<\/th>\n      <th>Turicibacter<\/th>\n      <th>Anaeroglobus<\/th>\n      <th>Dendrosporobacter<\/th>\n      <th>Victivallis<\/th>\n      <th>Aestuariispira<\/th>\n      <th>Vampirovibrio<\/th>\n      <th>Vulgatibacter<\/th>\n      <th>Pseudomaricurvus<\/th>\n      <th>Enterobacter<\/th>\n      <th>Escherichia.Shigella<\/th>\n      <th>Hafnia<\/th>\n      <th>Klebsiella<\/th>\n      <th>Lonsdalea<\/th>\n      <th>Cloacibacillus<\/th>\n      <th>Akkermansia<\/th>\n      <th>Actinomyces<\/th>\n      <th>Asaccharobacter<\/th>\n      <th>Oxobacter<\/th>\n      <th>Guggenheimella<\/th>\n      <th>Cellulosilyticum<\/th>\n      <th>Terrisporobacter<\/th>\n      <th>Anaerovibrio<\/th>\n      <th>Gordonibacter<\/th>\n      <th>Lactococcus<\/th>\n      <th>Parvimonas<\/th>\n      <th>Peptococcus<\/th>\n      <th>Clostridium.XI<\/th>\n      <th>Papillibacter<\/th>\n      <th>Bulleidia<\/th>\n      <th>Faecalitalea<\/th>\n      <th>Orientia<\/th>\n      <th>Pseudoteredinibacter<\/th>\n      <th>Rhodococcus<\/th>\n      <th>Sporosarcina<\/th>\n      <th>Leuconostoc<\/th>\n      <th>Oerskovia<\/th>\n      <th>Chryseomicrobium<\/th>\n      <th>Planococcaceae_incertae_sedis<\/th>\n      <th>Carnobacterium<\/th>\n      <th>Pediococcus<\/th>\n      <th>Anaerovirgula<\/th>\n      <th>Acetobacterium<\/th>\n      <th>Anaerofustis<\/th>\n      <th>Murimonas<\/th>\n      <th>N<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"t","scrollX":true,"scrollY":true,"scrollCollapse":true,"columnDefs":[{"className":"dt-right","targets":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>

???
- 300 genera
- Rows = Observations ; Columns = Bacteria ; each cell = counts
- highly variable abundance
- zero-inflation
- sequencing depth ; variable between observations
- higher taxonomic ranks by summing lower ranks up ; lower sparsity

---


# Data characteristics

- High-dimensional
- Compositional
- Zero-inflated
- Multivariate
- Unequal sequencing depth
- Over-dispersed

???

- here, 300, but possible up to multiple thousands
- multivariate; complex biological interactions
- over-dispersed ; relared to many used parametric models
- characteristics depend on taxonomic ranks

---

# Aims and challenges

.pull-left[
Challenges
- "neutral" evaluation of performance
- simulation of clustered / longitudinal effects
- evaluation of influence of data characteristics
- evaluation seperate for taxonomic ranks
]

.pull-right[
Aims
- guidance paper for (applied) researchers
- easily interpretable

]

---

# Data-generating mechanisms

- perfect model that reflects data-generating process unclear
- simulation based on parametric model may not represent true data structure
- possible solution:
      - resampling from a large set of samples taken from (healthy) subjects
      - parametric model "on-top" of resampled data
- drawbacks:
      - "spurious" effects due to resampling
      - effect of interest will be a combinations of "true" effect and noise in the data

---

# Data generating mechanisms
- `\(n_{obs} = [50,100,150,200,400,1000]\)`
- 


---

# Estimands / Effects in microbiome data

---

# Methods

---

# Performance measures

- Coverage  `$$Pr(\hat{\theta}_{low} &lt; \theta &lt; \hat{\theta}_{upp})$$`
- Power / type-I error rate $$ Pr(p_i \leq \alpha)$$
- Bias $$ E[\hat{\theta}] - \theta $$
- Empirical SE $$ \sqrt{Var(\hat{\theta})} $$
- MSE $$ E[(\hat{\theta} - \theta)^2] $$


---
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": false
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
